(()=>{var $1=(b)=>`Invalid expression type. Expression: ${b}`,v=(b)=>`Can't find an element with target ID: ${b}`,x=(b)=>`Route already exists: ${b}`;var Q1=(b)=>`x-${b} must be used on the same template as x-route`,g="targetID must be specified for programmatically added templates",c=(b)=>`Path: ${b} was not found`;function _(b){if(b.tagName.toLowerCase()!=="template")throw new TypeError("Directives can only be used on template elements.")}function U(b){if(_(b),b._x_PineconeRouter_route===void 0)throw new TypeError(Q1("template"))}function N(b){if(typeof b!="object"||!Array.isArray(b))throw new TypeError($1(b))}var $={hash:!1,basePath:"",globalHandlers:[],handleClicks:!0,targetID:void 0,preload:!1,fetchOptions:{},pushState:!0},d=(b)=>{return $={...$,...b},$};var m=(b,j,J)=>{if(b.indexOf(j)===-1)return J;let z=b[b.indexOf(j)+1];if(!z)return J;if(j==="target"){let Z=z.match(/([a-z0-9_-]+)/);if(Z)return Z[1]}return z},V=(b)=>{if(b=="notfound"||$.hash)return b;if(!b.startsWith($.basePath))b=$.basePath+b;return b},O=(b)=>{return/^\[.*\]$|^Array\(.*\)$/.test(b.trim())},h=(b,j)=>{let J=b??j??"",z=document.getElementById(J);if(J&&!z)throw new ReferenceError(v(J));return z??void 0},y=(b)=>{b.querySelectorAll("script").forEach((j)=>{let J=document.createElement("script");Array.from(j.attributes).forEach((z)=>J.setAttribute(z.name,z.value)),J.textContent=j.textContent,j.parentNode?.replaceChild(J,j)})};var S=new Set,T=new Map,w=new Map,P=new Set,u=(b,j)=>{document.dispatchEvent(new CustomEvent("pinecone:fetch-error",{detail:{error:b,url:j}}))},p=(b,j,J,z,Z)=>{let G=j.id+J;if(S.has(G))return;S.add(G);let Q=j.content,Y=Array(Q.childElementCount);y(Q);let X=Array.from(Q.children);for(let K=0;K<X.length;K++)Y[K]=X[K].cloneNode(!0),b.addScopeToNode(Y[K],{},j);b.mutateDom(()=>{if(z)z.replaceChildren(...Y);else j.after(...Y);Y.forEach((K)=>{b.initTree(K)})}),j._x_PineconeRouter_template=Y,j._x_PineconeRouter_templateUrls=Z,j._x_PineconeRouter_undoTemplate=()=>{b.mutateDom(()=>{Y.forEach((K)=>{b.destroyTree(K),K.remove()})}),delete j._x_PineconeRouter_template},b.nextTick(()=>S.delete(G))},E=(b)=>{if(b._x_PineconeRouter_undoTemplate)b._x_PineconeRouter_undoTemplate(),delete b._x_PineconeRouter_undoTemplate},n=async(b,j,J,z,Z)=>{if(j._x_PineconeRouter_templateUrls!=null&&j._x_PineconeRouter_templateUrls!=z)E(j),j.innerHTML="";if(j._x_PineconeRouter_template)return;if(j.content.childElementCount){p(b,j,J,Z,z);return}if(z)return I(z,j).then(()=>p(b,j,J,Z,z))},D=(b,j)=>{return b.map((J)=>J.replace(/:([^/.]+)/g,(z,Z)=>j[Z]||Z))},o=async(b,j="high")=>{if(b=V(b),T.has(b))return T.get(b);if(w.has(b))return w.get(b);let J=fetch(b,{...$.fetchOptions,priority:j}).then((z)=>{if(!z.ok)return u(z.statusText,b),"";return z.text()}).then((z)=>{if(z)T.set(b,z);return w.delete(b),z||""}).catch((z)=>{if(z instanceof TypeError)u(z.message,b);return""});return w.set(b,J),J},k=(b,j)=>{P.add({urls:b,el:j})},i=()=>{for(let b of P){if(b.el)I(b.urls,b.el,"low");else b.urls.map((j)=>o(j,"low"));P.delete(b)}},I=(b,j,J="high")=>Promise.all(b.map((z)=>o(z,J))).then((z)=>{j.innerHTML=z.join("")});var Y1=(b,j)=>{b.directive("template",(J,{expression:z,modifiers:Z},{evaluate:G,cleanup:Q,Alpine:Y,effect:X})=>{U(J);let K=h(m(Z,"target"),$.targetID),W=J._x_PineconeRouter_route,M,B=Z.includes("interpolate");if(z!=""){if(!O(z))z=`['${z}']`;let q=G(z);if(N(q),M=q,!B&&($.preload||Z.includes("preload")))k(M,J);let C=j.routes.get(W);C.templates=M}let F=(q)=>{if(j.context.route?.path===W){if(q&&B)q=D(q,j.context.params);n(Y,J,z,q,K).then(()=>{j.loading=!1})}else E(J)},H=X(()=>F(M));Q(()=>{J._x_PineconeRouter_undoTemplate&&J._x_PineconeRouter_undoTemplate(),Y.release(H)})})},s=Y1;var G1=(b,j)=>{b.directive("handler",(J,{expression:z,modifiers:Z},{evaluate:G,cleanup:Q})=>{if(!O(z))z=`[${z}]`;let Y=G(z);N(Y);let X=Y;for(let W=0;W<X.length;W++)X[W]=X[W].bind(b.$data(J));let K;if(Z.includes("global"))$.globalHandlers=X;else{U(J);let W=J._x_PineconeRouter_route;K=j.routes.get(W),K.handlers=X}Q(()=>{if(Z.includes("global"))$.globalHandlers=[];else K.handlers=[]})}).before("template")},a=G1;var W1=(b,j)=>{b.directive("route",(J,{expression:z,value:Z},{cleanup:G})=>{let Q=$.hash?z:V(z);if(_(J),Q!="notfound")j.add(Q,{name:Z});J._x_PineconeRouter_route=Q,G(()=>{j.routes.delete(Q),delete J._x_PineconeRouter_route})}).before("handler")},l=W1;var r=()=>{return{entries:[],index:0,canGoBack:function(){return this.index>0},back:function(){this.to(this.index-1)},canGoForward:function(){return this.index<this.entries.length-1},forward:function(){this.to(this.index+1)},to:function(b){if(b in this.entries)this.router?.navigate(this.entries[b],!1,!1,b)},push:function(b,j){if(this.index<this.entries.length-1)this.entries=this.entries.slice(0,this.index+1);if(this.entries.push(b),this.index=this.entries.length-1,j)this.pushState(b)},pushState:function(b){if(!$.pushState)return;let j=$.hash&&!b.startsWith("#")?"#"+b:b,J={path:j};history.pushState(J,"",j)},setRouter(b){this.router=b}}};var X1=(b,{targetID:j,templates:J=[],handlers:z=[],interpolate:Z=!1,name:G}={})=>({programmaticTemplates:J.length>0,pattern:H1(b),interpolate:Z,templates:J,targetID:j,handlers:z,name:G||b,path:b,match(Q){let Y=this.pattern.exec(Q);if(Y)return{...Y.groups}}});function H1(b){let J=b.split("/").filter(Boolean).map((z)=>{if(!z.startsWith(":"))return"/"+z;let[,Z,G,Q]=z.match(/^:(\w+)([?+*]?)(?:\.(.+))?$/)||[],Y=G==="*"||G==="+",X=G==="?"||G==="*",W=`(?<${Z}>${Y?X?".*?":".+":"[^/]+?"})`,M=Q?`\\.${Q}`:"",B=W+M;if(X)return`(?:/${B})?`;return`/${B}`}).join("");return new RegExp(`^${J}/?$`,"i")}var f=X1;var R=(b,j,J)=>{return{path:b,params:j,route:J}};async function t(b,j,J){let z;return new Promise(async(Z,G)=>{J.signal.addEventListener("abort",()=>G());for(let Q of b){if(J.signal.aborted)return;let Y={...j,data:z};try{z=await Q(Y,J)}catch(X){G(X)}}Z()})}var e=(b,j,J)=>{let z=f("notfound",{handlers:[(K)=>console.error(new ReferenceError(c(K.path)))],name:"notfound"}),Z=new Map([["notfound",z]]),G=R(J,{}),Q=null,Y=!1,X={name:b,version:j,history:r(),routes:Z,context:G,get loading(){return Y},set loading(K){if(Y==K)return;Y=K,document.dispatchEvent(new Event(K?"pinecone:start":"pinecone:end"))},settings:(K)=>d(K),add:function(K,W){if(K!="notfound"){if(!$.hash)K=V(K);if(this.routes.has(K))throw new Error(x(K))}if(W.templates&&($.preload||W.preload))k(W.templates);this.routes.set(K,f(K,W))},remove:function(K){this.routes.delete(K)},navigate:async function(K,W,M,B){if(Q)Q.abort();Q=new AbortController,this.loading=!0,K=V(K);let F=K.split("?")[0]||"/",{route:H,params:q}=this.match(F),C=R(F,q,H),A=$.globalHandlers.concat(H.handlers);if(A.length){try{await t(A,C,Q)}catch(L){this.loading=!1;return}if(!H.templates)this.loading=!1}if(B!=null)this.history.index=B,this.history.pushState(K);else if(M||K!=this.context.path)this.history.push(K,!W&&!M);if(this.context=C,H.programmaticTemplates){let L=document.getElementById(H.targetID??$.targetID??"");if(!L)throw new Error(g);let Z1=H.interpolate?D(H.templates,q):H.templates;I(Z1,L).finally(()=>{y(L),this.loading=!1})}if(!H.templates.length)this.loading=!1},match:function(K){let W=this.routes.get("notfound"),M={};for(let[B,F]of this.routes){let H=F.match(K);if(H){M=H,W=F;break}}return{route:W,params:M}}};return X.history.setRouter(X),X};var b1=(b)=>{window.document.body.addEventListener("click",(j)=>{if(j.ctrlKey||j.metaKey||j.altKey||j.shiftKey||j.button||j.defaultPrevented)return;let J=j.target.closest("a");if(!J)return;if($.handleClicks===!1&&!J.hasAttribute("x-link")||J.hasAttribute("data-native")||J.hasAttribute("native"))return;let z=J.getAttribute("href"),Z=J.getAttribute("target");if(z&&(!Z||/^_?self$/i.test(Z)))b.navigate(z),j.preventDefault()})};var J1="pinecone-router",z1="7.3.0";var M1=function(b){let j=()=>{return $.hash?location.hash.substring(1):location.pathname},J=b.reactive(e(J1,z1,j()));window.PineconeRouter=J,document.addEventListener("alpine:initialized",()=>{J.navigate(j(),!1,!0)}),window.addEventListener("popstate",()=>{J.navigate($.hash?window.location.hash.substring(1):window.location.pathname,!0)}),b1(J),document.addEventListener("pinecone:end",()=>b.nextTick(i),{once:!0}),s(b,J),a(b,J),l(b,J),b.$router=J,b.magic("router",()=>J),b.magic("history",()=>J.history),b.magic("params",()=>J.context.params)},K1=M1;document.addEventListener("alpine:init",()=>{window.Alpine.plugin(K1)});})();

//# debugId=364919D890AA4F4B64756E2164756E21
//# sourceMappingURL=router.min.js.map
