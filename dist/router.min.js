(()=>{var k=class{params={};path;handlers=[];constructor(t,u={}){this.path=t,Object.keys(u).forEach(l=>{this[l]=u[l]}),u.templates&&(this.programmaticTemplates=!0)}templates=[];templateTargetId="";programmaticTemplates=!1;handlersDone=!1;preload=!1;cancelHandlers},L=k;function C(s){return s.replace(/(^\/+|\/+$)/g,"").split("/")}function D(s,t){let u=/(?:\?([^#]*))?(#.*)?$/,l=s.match(u),m={},v;if(l&&l[1]){let c=l[1].split("&");for(let d=0;d<c.length;d++){let x=c[d].split("=");m[decodeURIComponent(x[0])]=decodeURIComponent(x.slice(1).join("="))}}let _=C(s.replace(u,"")),p=C(t||""),E=Math.max(_.length,p.length);for(let c=0;c<E;c++)if(p[c]&&p[c].charAt(0)===":"){let d=p[c].replace(/(^:|[+*?]+$)/g,""),x=(p[c].match(/[+*?]+$/)||{}).toString()[0],R=~x.indexOf("+"),P=~x.indexOf("*"),y=_[c]||"";if(!y&&!P&&(x.indexOf("?")<0||R)){v=!1;break}if(m[d]=decodeURIComponent(y),R||P){m[d]=_.slice(c).map(decodeURIComponent).join("/");break}}else if(p[c]!==_[c]){v=!1;break}return v===!1?!1:m}function b(s,...t){if(window.PineconeRouterMiddlewares)for(let u in window.PineconeRouterMiddlewares){let l=window.PineconeRouterMiddlewares[u];if(l[s]==null)return;if(l[s](...t)=="stop")return"stop"}}function W(s){let t=s.reactive({version:"6.0.0",name:"pinecone-router",settings:{hash:!1,basePath:"/",templateTargetId:null,interceptLinks:!0,alwaysSendLoadingEvents:!1},notfound:new L("notfound"),routes:[],globalHandlers:[],context:{route:"",path:"",params:{},query:window.location.search.substring(1),hash:window.location.hash.substring(1),navigationStack:[],navigationIndex:0,redirect(e){return this.navigate(e),"stop"},navigate(e){w(e,!1,!1,null)},canGoBack(){return this.navigationIndex>0},back(){w(this.navigationStack[this.navigationIndex-1],!1,!1,this.navigationIndex-1)},canGoForward(){return this.navigationIndex<this.navigationStack.length-1},forward(){w(this.navigationStack[this.navigationIndex+1],!1,!1,this.navigationIndex+1)}},endEventDispatched:!1,startEventDispatched:!1,add(e,n){if(this.routes.find(a=>a.path==e)!=null)throw new Error("Pinecone Router: route already exist");return n?.templates&&n?.preload&&E(null,n.templates,!0),this.routes.push(new L(e,n))-1},remove(e){this.routes=this.routes.filter(n=>n.path!=e)},loadStart:new Event("pinecone-start"),loadEnd:new Event("pinecone-end")});window.PineconeRouter=t;var u={},l={};let m=new Set,v=(e,n,a)=>{if(m.has(n))return;m.add(n);let i=e.content.cloneNode(!0).firstElementChild;i&&(s.addScopeToNode(i,{},e),s.mutateDom(()=>{a!=null?a.replaceChildren(i):e.after(i),s.initTree(i)}),e._x_PineconeRouter_CurrentTemplate=i,e._x_PineconeRouter_undoTemplate=()=>{i.remove(),delete e._x_PineconeRouter_CurrentTemplate},s.nextTick(()=>m.delete(n)))};function _(e){e._x_PineconeRouter_undoTemplate&&(e._x_PineconeRouter_undoTemplate(),delete e._x_PineconeRouter_undoTemplate)}function p(e,n,a,i,r=!1){if(e._x_PineconeRouter_CurrentTemplate)return e._x_PineconeRouter_CurrentTemplate;e.content.firstElementChild?(v(e,n,i),r||d()):a&&(a.every(o=>l[o])?(a.length>1&&(e.innerHTML="<templates-wrapper>"),a.forEach(o=>{e.innerHTML+=l[o]}),a.length>1&&(e.innerHTML="</templates-wrapper>"),v(e,n,i),d()):E(e,a).then(()=>v(e,n,i)).finally(()=>d()))}let E=(e,n,a=!1)=>{let i=n.map(r=>u[r]?u[r]:l[r]?new Promise(o=>{o(l[r])}):(u[r]=fetch(r).then(o=>o.ok?o.text():(x(o.statusText),null)).then(o=>o==null?(l[r]=null,u[r]=null,null):(l[r]=o,u[r]=null,o)),u[r]));return Promise.all(i).then(r=>{let o=r.filter(f=>f!==null).join("");return e?(n.length>1&&!a?e.innerHTML="<templates-wrapper>"+o+"</templates-wrapper>":e.innerHTML=o,e.innerHTML):o})},c=()=>{t.startEventDispatched||document.dispatchEvent(t.loadStart),t.startEventDispatched=!0},d=()=>{t.endEventDispatched||document.dispatchEvent(t.loadEnd),t.endEventDispatched=!0};function x(e){document.dispatchEvent(new CustomEvent("fetch-error",{detail:e}))}let R=e=>!t.settings.hash&&t.settings.basePath!="/"?t.settings.basePath+e:e,P=e=>t.routes.findIndex(n=>n.path==e);s.directive("template",(e,{modifiers:n,expression:a},{Alpine:i,effect:r,evaluate:o,cleanup:f})=>{if(!e._x_PineconeRouter_route)throw new Error("Pinecone Router: x-template must be used on the same element as x-route.");if(e.content.firstElementChild!=null)throw new Error("Pinecone Router: x-template cannot be used alongside an inline template (template element should not have a child).");!(a.startsWith("[")&&a.endsWith("]"))&&!(a.startsWith("Array(")&&a.endsWith(")"))&&(a=`['${a}']`);let g=o(a),h;if(typeof g=="object")h=g;else throw new Error(`Pinecone Router: Invalid template type: ${typeof g}.`);let T=M(n,"target",null)??window.PineconeRouter.settings.templateTargetId,H=document.getElementById(T);if(T&&!H)throw new Error("Pinecone Router: Can't find an element with the suplied target ID: "+T);n.includes("preload")&&E(e,h,!1);let S=e._x_PineconeRouter_route,I=S=="notfound"?t.notfound:t.routes[P(S)];I.templates=h,i.nextTick(()=>{r(()=>{I.handlersDone&&t.context.route==I.path?p(e,a,h,H):_(e)})}),f(()=>{e._x_PineconeRouter_undoTemplate&&e._x_PineconeRouter_undoTemplate()})}),s.directive("handler",(e,{expression:n,modifiers:a},{evaluate:i,cleanup:r})=>{if(!a.includes("global")&&!e._x_PineconeRouter_route)throw new Error("Pinecone Router: x-handler must be set on the same element as x-route, or on the router element with the modifier .global.");let o;!(n.startsWith("[")&&n.endsWith("]"))&&!(n.startsWith("Array(")&&n.endsWith(")"))&&(n=`[${n}]`);let f=i(n);if(typeof f=="object")o=f;else throw new Error(`Pinecone Router: Invalid handler type: ${typeof f}.`);for(let h=0;h<o.length;h++)o[h]=o[h].bind(s.$data(e));let g;if(a.includes("global"))t.globalHandlers=o;else{let h=e._x_PineconeRouter_route;g=h=="notfound"?t.notfound:t.routes[P(h)],g.handlers=o}r(()=>{a.includes("global")?t.globalHandlers=[]:(g.handlers=[],g.handlersDone=!0,g.cancelHandlers=!1)})}).before("template"),s.directive("route",(e,{expression:n,modifiers:a},{effect:i,cleanup:r})=>{let o=n;if(b("onBeforeRouteProcessed",e,o),o.indexOf("#")>-1)throw new Error("Pinecone Router: A route's path may not have a hash character.");let f=M(a,"target",null)??window.PineconeRouter.settings.templateTargetId,g=document.getElementById(f);if(f&&!g)throw new Error("Pinecone Router: Can't find an element with the suplied target ID: "+f);let h=null;o!="notfound"&&(o=R(o),h=t.add(o));let T=t.routes[h]??t.notfound;e._x_PineconeRouter_route=o,e.content.firstElementChild!=null&&s.nextTick(()=>{i(()=>{T.handlersDone&&t.context.route==o?p(e,n,null,g,!0):_(e)})}),r(()=>{e._x_PineconeRouter_undoTemplate&&e._x_PineconeRouter_undoTemplate(),t.remove(o),delete e._x_PineconeRouter_route}),b("onAfterRouteProcessed",e,o)}).before("handler"),s.$router=t.context,s.magic("router",()=>t.context),document.addEventListener("alpine:initialized",()=>{b("init"),t.settings.hash==!1?w(location.pathname+location.search,!1,!0):w(location.hash.substring(1),!1,!0)}),window.addEventListener("popstate",()=>{t.settings.hash?window.location.hash!=""&&w(window.location.hash.substring(1),!0):w(window.location.pathname,!0)}),y();function y(){function e(n){if(!n||!n.getAttribute)return;let a=n.getAttribute("href"),i=n.getAttribute("target");if(!(!a||!a.match(/^\//g)||i&&!i.match(/^_?self$/i)))return typeof a!="string"&&a.url&&(a=a.url),a}window.document.body.addEventListener("click",function(n){if(n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.button||n.defaultPrevented)return;let a=t.routes[P(t.context.route)]??t.notfound;a.handlersDone||(a.cancelHandlers=!0,d());let i=n.target;do if(i.localName==="a"&&i.getAttribute("href")){if(window.PineconeRouter.settings.interceptLinks==!1&&!i.hasAttribute("x-link")||i.hasAttribute("data-native")||i.hasAttribute("native"))return;let r=e(i);r&&(w(r),n.stopImmediatePropagation&&n.stopImmediatePropagation(),n.stopPropagation&&n.stopPropagation(),n.preventDefault());break}while(i=i.parentNode)})}async function w(e,n=!1,a=!1,i=null){t.startEventDispatched=!1,t.endEventDispatched=!1,e||(e="/"),t.settings.hash||(t.settings.basePath!="/"&&!e.startsWith(t.settings.basePath)&&(e=t.settings.basePath+e),e==t.settings.basePath&&!e.endsWith("/")&&(e+="/")),i!=null?t.context.navigationIndex=i:e!=t.context.path&&(t.context.navigationIndex!==t.context.navigationStack.length-1?(t.context.navigationStack=t.context.navigationStack.slice(0,t.context.navigationIndex+1),t.context.navigationStack.push(e),t.context.navigationIndex=t.context.navigationStack.length-1):(t.context.navigationStack.push(e),t.context.navigationIndex=t.context.navigationStack.length-1));let r=t.routes.find(o=>{let f=D(e,o.path);return o.params=f!=!1?f:{},f!=!1})??t.notfound;if(r.handlersDone=!r.handlers.length&&!t.globalHandlers.length,(t.settings.alwaysSendLoadingEvents||(r.handlers.length||t.globalHandlers.length||r.templates.length)&&t.context.path!=e)&&c(),$(r.path,e,r.params),b("onBeforeHandlersExecuted",r,e,a)=="stop"){d();return}if(!n){let o="";if(t.settings.hash?(o="#",o+=e):(o=e,o+=window.location.hash),!a)history.pushState({path:o},"",o);else if(t.settings.hash&&e=="/")return w("/",!1,!1)}if(r&&(r.handlers.length||t.globalHandlers.length)){if(r.cancelHandlers=!1,!await B(t.globalHandlers.concat(r.handlers),t.context)){d();return}r.handlersDone=!0,r.templates||d()}if(r.templates.length&&r.programmaticTemplates){let o=r.templateTargetId?document.getElementById(r.templateTargetId):document.getElementById(t.settings.templateTargetId);E(o,r.templates,r.programmaticTemplates).then(()=>{d()})}t.settings.alwaysSendLoadingEvents&&!t.endEventDispatched&&d(),b("onHandlersExecuted",r,e,a)}function $(e,n,a){t.context.route=e,t.context.path=n,t.context.params=a,t.context.query=window.location.search.substring(1),t.context.hash=window.location.hash.substring(1)}function M(e,n,a){if(e.indexOf(n)===-1)return a;let i=e[e.indexOf(n)+1];if(!i)return a;if(n==="target"){let r=i.match(/([a-z0-9_-]+)/);if(r)return r[1]}return i}async function B(e,n){for(let a=0;a<e.length;a++)if(typeof e[a]=="function"){let i=t.routes[P(n.route)]??t.notfound;if(i.cancelHandlers)return i.cancelHandlers=!1,!1;let r;if(e[a].constructor.name==="AsyncFunction"?r=await e[a](n):r=e[a](n),r=="stop")return!1}return!0}}document.addEventListener("alpine:init",()=>{window.Alpine.plugin(W)});})();
//# sourceMappingURL=router.min.js.map
