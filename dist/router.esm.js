var $1=(j)=>`Invalid expression type. Expression: ${j}`,A=(j)=>`Can't find an element with target ID: ${j}`,x=(j)=>`Route already exists: ${j}`;var Q1=(j)=>`x-${j} must be used on the same template as x-route`,g="targetID must be specified for programmatically added templates",c=(j)=>`Path: ${j} was not found`;function I(j){if(j.tagName.toLowerCase()!=="template")throw new TypeError("Directives can only be used on template elements.")}function L(j){if(I(j),j._x_PineconeRouter_route===void 0)throw new TypeError(Q1("template"))}function U(j){if(typeof j!="object"||!Array.isArray(j))throw new TypeError($1(j))}var $={hash:!1,basePath:"",globalHandlers:[],handleClicks:!0,targetID:void 0,preload:!1,fetchOptions:{},pushState:!0},d=(j)=>{return $={...$,...j},$};var m=(j,b,J)=>{if(j.indexOf(b)===-1)return J;let z=j[j.indexOf(b)+1];if(!z)return J;if(b==="target"){let Z=z.match(/([a-z0-9_-]+)/);if(Z)return Z[1]}return z},V=(j)=>{if(j=="notfound"||$.hash)return j;if(!j.startsWith($.basePath))j=$.basePath+j;return j},y=(j)=>{return/^\[.*\]$|^Array\(.*\)$/.test(j.trim())},h=(j,b)=>{let J=j??b??"",z=document.getElementById(J);if(J&&!z)throw new ReferenceError(A(J));return z??void 0},u=(j)=>{j.querySelectorAll("script").forEach((b)=>{let J=document.createElement("script");Array.from(b.attributes).forEach((z)=>J.setAttribute(z.name,z.value)),J.textContent=b.textContent,b.parentNode?.replaceChild(J,b)})};var _=new Set,S=new Map,N=new Map,T=new Set,p=(j,b)=>{document.dispatchEvent(new CustomEvent("pinecone:fetch-error",{detail:{error:j,url:b}}))},P=(j,b,J,z,Z)=>{let Q=b.id+J;if(_.has(Q))return;_.add(Q);let G=b.content,Y=Array(G.childElementCount);u(G);let M=Array.from(G.children);for(let K=0;K<M.length;K++)if(Y[K]=M[K].cloneNode(!0),z)j.addScopeToNode(Y[K],{},z);else j.addScopeToNode(Y[K],{},b);j.mutateDom(()=>{if(z)z.replaceChildren(...Y);else b.after(...Y);Y.forEach((K)=>{j.initTree(K)})}),b._x_PineconeRouter_template=Y,b._x_PineconeRouter_templateUrls=Z,b._x_PineconeRouter_undoTemplate=()=>{j.mutateDom(()=>{Y.forEach((K)=>{j.destroyTree(K),K.remove()})}),delete b._x_PineconeRouter_template},j.nextTick(()=>_.delete(Q))},f=(j)=>{if(j._x_PineconeRouter_undoTemplate)j._x_PineconeRouter_undoTemplate(),delete j._x_PineconeRouter_undoTemplate},o=async(j,b,J,z,Z)=>{if(b._x_PineconeRouter_templateUrls!=null&&b._x_PineconeRouter_templateUrls!=z)f(b),b.innerHTML="";if(b._x_PineconeRouter_template)return;if(b.content.childElementCount){P(j,b,J,Z,z);return}if(z)return D(z,b).then(()=>P(j,b,J,Z,z))},O=(j,b)=>{return j.map((J)=>J.replace(/:([^/.]+)/g,(z,Z)=>b[Z]||Z))},n=async(j,b="high")=>{if(j=V(j),S.has(j))return S.get(j);if(N.has(j))return N.get(j);let J=fetch(j,{...$.fetchOptions,priority:b}).then((z)=>{if(!z.ok)return p(z.statusText,j),"";return z.text()}).then((z)=>{if(z)S.set(j,z);return N.delete(j),z||""}).catch((z)=>{if(z instanceof TypeError)p(z.message,j);return""});return N.set(j,J),J},w=(j,b)=>{T.add({urls:j,el:b})},i=()=>{for(let j of T){if(j.el)D(j.urls,j.el,"low");else j.urls.map((b)=>n(b,"low"));T.delete(j)}},D=(j,b,J="high")=>Promise.all(j.map((z)=>n(z,J))).then((z)=>{let Z=z.join("");if(b instanceof HTMLTemplateElement){b.innerHTML=Z;return}let Q=document.createElement("template");Q.innerHTML=Z.trim(),P(window.Alpine,Q,"",b,j),Q.remove()});var Y1=(j,b)=>{j.directive("template",(J,{expression:z,modifiers:Z},{evaluate:Q,cleanup:G,Alpine:Y,effect:M})=>{L(J);let K=h(m(Z,"target"),$.targetID),H=J._x_PineconeRouter_route,X,B=Z.includes("interpolate");if(z!=""){if(!y(z))z=`['${z}']`;let q=Q(z);if(U(q),X=q,!B&&($.preload||Z.includes("preload")))w(X,J);let C=b.routes.get(H);C.templates=X}let F=(q)=>{if(b.context.route?.path===H){if(q&&B)q=O(q,b.context.params);o(Y,J,z,q,K).then(()=>{b.loading=!1})}else f(J)},W=M(()=>F(X));G(()=>{J._x_PineconeRouter_undoTemplate&&J._x_PineconeRouter_undoTemplate(),Y.release(W)})})},s=Y1;var G1=(j,b)=>{j.directive("handler",(J,{expression:z,modifiers:Z},{evaluate:Q,cleanup:G})=>{if(!y(z))z=`[${z}]`;let Y=Q(z);U(Y);let M=Y;for(let H=0;H<M.length;H++)M[H]=M[H].bind(j.$data(J));let K;if(Z.includes("global"))$.globalHandlers=M;else{L(J);let H=J._x_PineconeRouter_route;K=b.routes.get(H),K.handlers=M}G(()=>{if(Z.includes("global"))$.globalHandlers=[];else K.handlers=[]})}).before("template")},a=G1;var H1=(j,b)=>{j.directive("route",(J,{expression:z,value:Z},{cleanup:Q})=>{let G=$.hash?z:V(z);if(I(J),G!="notfound")b.add(G,{name:Z});J._x_PineconeRouter_route=G,Q(()=>{b.routes.delete(G),delete J._x_PineconeRouter_route})}).before("handler")},r=H1;var l=()=>{return{entries:[],index:0,canGoBack:function(){return this.index>0},back:function(){this.to(this.index-1)},canGoForward:function(){return this.index<this.entries.length-1},forward:function(){this.to(this.index+1)},to:function(j){if(j in this.entries)this.router?.navigate(this.entries[j],!1,!1,j)},push:function(j,b){if(this.index<this.entries.length-1)this.entries=this.entries.slice(0,this.index+1);if(this.entries.push(j),this.index=this.entries.length-1,b)this.pushState(j)},pushState:function(j){if(!$.pushState)return;let b=$.hash&&!j.startsWith("#")?"#"+j:j,J={path:b};history.pushState(J,"",b)},setRouter(j){this.router=j}}};var M1=(j,{targetID:b,templates:J=[],handlers:z=[],interpolate:Z=!1,name:Q}={})=>({programmaticTemplates:J.length>0,pattern:W1(j),interpolate:Z,templates:J,targetID:b,handlers:z,name:Q||j,path:j,match(G){let Y=this.pattern.exec(G);if(Y)return{...Y.groups}}});function W1(j){let J=j.split("/").filter(Boolean).map((z)=>{if(!z.startsWith(":"))return"/"+z;let[,Z,Q,G]=z.match(/^:(\w+)([?+*]?)(?:\.(.+))?$/)||[],Y=Q==="*"||Q==="+",M=Q==="?"||Q==="*",H=`(?<${Z}>${Y?M?".*?":".+":"[^/]+?"})`,X=G?`\\.${G}`:"",B=H+X;if(M)return`(?:/${B})?`;return`/${B}`}).join("");return new RegExp(`^${J}/?$`,"i")}var E=M1;var R=(j,b,J)=>{return{path:j,params:b,route:J}};async function t(j,b,J){let z;return new Promise(async(Z,Q)=>{J.signal.addEventListener("abort",()=>Q());for(let G of j){if(J.signal.aborted)return;let Y={...b,data:z};try{z=await G(Y,J)}catch(M){Q(M)}}Z()})}var e=(j,b,J)=>{let z=E("notfound",{handlers:[(K)=>console.error(new ReferenceError(c(K.path)))],name:"notfound"}),Z=new Map([["notfound",z]]),Q=R(J,{}),G=null,Y=!1,M={name:j,version:b,history:l(),routes:Z,context:Q,get loading(){return Y},set loading(K){if(Y==K)return;Y=K,document.dispatchEvent(new Event(K?"pinecone:start":"pinecone:end"))},settings:(K)=>d(K),add:function(K,H){if(K!="notfound"){if(!$.hash)K=V(K);if(this.routes.has(K))throw new Error(x(K))}if(H.templates&&($.preload||H.preload))w(H.templates);this.routes.set(K,E(K,H))},remove:function(K){this.routes.delete(K)},navigate:async function(K,H,X,B){if(G)G.abort();G=new AbortController,this.loading=!0,K=V(K);let F=K.split("?")[0]||"/",{route:W,params:q}=this.match(F),C=R(F,q,W),v=$.globalHandlers.concat(W.handlers);if(v.length){try{await t(v,C,G)}catch(k){this.loading=!1;return}if(!W.templates)this.loading=!1}if(B!=null)this.history.index=B,this.history.pushState(K);else if(X||K!=this.context.path)this.history.push(K,!H&&!X);if(this.context=C,W.programmaticTemplates){let k=document.getElementById(W.targetID??$.targetID??"");if(!k)throw new Error(g);let Z1=W.interpolate?O(W.templates,q):W.templates;D(Z1,k).finally(()=>{this.loading=!1})}if(!W.templates.length)this.loading=!1},match:function(K){let H=this.routes.get("notfound"),X={};for(let[B,F]of this.routes){let W=F.match(K);if(W){X=W,H=F;break}}return{route:H,params:X}}};return M.history.setRouter(M),M};var j1=(j)=>{window.document.body.addEventListener("click",(b)=>{if(b.ctrlKey||b.metaKey||b.altKey||b.shiftKey||b.button||b.defaultPrevented)return;let J=b.target.closest("a");if(!J)return;if($.handleClicks===!1&&!J.hasAttribute("x-link")||J.hasAttribute("data-native")||J.hasAttribute("native"))return;let z=J.getAttribute("href"),Z=J.getAttribute("target");if(z&&(!Z||/^_?self$/i.test(Z)))j.navigate(z),b.preventDefault()})};var J1="pinecone-router",z1="7.3.1";var X1=function(j){let b=()=>{return $.hash?location.hash.substring(1):location.pathname},J=j.reactive(e(J1,z1,b()));window.PineconeRouter=J,document.addEventListener("alpine:initialized",()=>{J.navigate(b(),!1,!0)}),window.addEventListener("popstate",()=>{J.navigate($.hash?window.location.hash.substring(1):window.location.pathname,!0)}),j1(J),document.addEventListener("pinecone:end",()=>j.nextTick(i),{once:!0}),s(j,J),a(j,J),r(j,J),j.$router=J,j.magic("router",()=>J),j.magic("history",()=>J.history),j.magic("params",()=>J.context.params)},K1=X1;var G3=K1;export{G3 as default};

//# debugId=0EE67B89DBC2882764756E2164756E21
//# sourceMappingURL=router.esm.js.map
